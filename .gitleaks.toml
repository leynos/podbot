# Gitleaks configuration for podbot.
#
# Extends the default ruleset and adds path-based allowlists for
# test-only PEM fixtures and PEM header detection constants.

[allowlist]
description = "Test-only keys and PEM header detection constants"

paths = [
    # Test fixture keys generated by openssl for unit and BDD tests.
    # These keys have zero security value and are committed deliberately.
    '''tests/fixtures/test_rsa_private_key\.pem''',
    '''tests/fixtures/test_ec_private_key\.pem''',
    '''tests/fixtures/test_ed25519_private_key\.pem''',
]

regexTarget = "line"

[[rules]]
id = "pem-header-detection-constants"
description = "PEM header string constants used for key type detection"
regex = '''-----BEGIN (EC |OPENSSH |ENCRYPTED |RSA )?PRIVATE KEY-----'''
allowlist.paths = [
    '''src/github/mod\.rs''',
    '''src/github/tests\.rs''',
    '''tests/bdd_github_private_key_helpers/steps\.rs''',
    '''docs/users-guide\.md''',
]
